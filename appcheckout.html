<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"
/>
    <title>Purpose Driven Planner | Checkout for pdf version of the planner</title>
    <link rel="stylesheet" href="./css/main.css" />
</head>
<body>
           
    <!-- Insert these scripts at the bottom of the HTML, but before you use any Firebase services -->

    <!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/8.2.1/firebase-app.js"></script>

    <!-- If you enabled Analytics in your project, add the Firebase SDK for Analytics -->
    <script src="https://www.gstatic.com/firebasejs/8.2.1/firebase-analytics.js"></script>

    <!-- Add Firebase products that you want to use -->
    <script src="https://www.gstatic.com/firebasejs/8.2.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.2.1/firebase-firestore.js"></script>
    <div class="checkoutContainer">
        <div class="checkout__header">
            <div class="checkout__header-heading">
                <h1>Purpose Driven Planner</h1>
                <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Nobis itaque voluptas sit eveniet ipsam quaerat!</p>
            </div>
            <div class="checkout__header-logo">
                <img src="./img/pdp-logo.svg" alt="">
            </div>
        </div>
        <div class="checkout__content">
            <form action="" class="checkoutForm">
                <h2 class="checkoutForm__heading">Checkout Form</h2>
                <p class="checkoutError hidden">Please fill out all of the fields</p>
                <div class="checkoutForm__group mb-3">
                    <label for="">Email:</label>
                    <input type="email" name="" placeholder="Enter your email here" required id="email">
                </div>
                <div class="checkoutForm__group mb-3">
                    <label for="">Password:</label>
                    <input type="password" name="" placeholder="Enter your password here" required id="password">
                </div>
                <div class="checkoutForm__group mb-3">
                    <label for="">Confirm Your Password:</label>
                    <input type="password" name="" placeholder="Confirm your password here" required id="passwordConfirm">
                </div>
                <div id="smart-button-container">
                    <div style="text-align: center;">
                      <div id="paypal-button-container"></div>
                    </div>
                  </div>
                <script src="https://www.paypal.com/sdk/js?client-id=sb&currency=USD" data-sdk-integration-source="button-factory"></script>
                <script>
                  function initPayPalButton() {
                    const firebaseApp = firebase.initializeApp({
                            apiKey: 'AIzaSyCUgUFUERm9rrm47vmBc-V95lgxBUHZ0sM',
                            authDomain: 'pdplanner-a30ab.firebaseapp.com',
                            databaseURL: 'https://pdplanner-a30ab.firebaseio.com/',
                            projectId: 'pdplanner-a30ab',
                            storageBucket: 'pdplanner-a30ab.appspot.com',
                            messagingSenderId: '738390097709',
                            appId: '1:738390097709:web:0d28ce750c3f940277dda4',
                            measurementId: 'G-XXKW1DJ1PZ'
                        })
                    paypal.Buttons({
                      style: {
                        shape: 'pill',
                        color: 'white',
                        layout: 'vertical',
                        label: 'paypal',
                      },

                      onInit: function(data, actions) {
                            // Disable the buttons
                            let valid1 = false;
                            let valid2 = false;
                            let valid3 = false;
                            actions.disable();
                            document.querySelector('#email').addEventListener('input', (e) => {
                                if (/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e.target.value)){
                                    valid2 = true;
                                } else {
                                    valid2 = false;
                                }
                                if(valid1 && valid2 && valid3){
                                    document.querySelector('.checkoutError').classList.add('hidden');
                                    actions.enable();
                                } else {
                                    document.querySelector('.checkoutError').classList.remove('hidden');
                                    actions.disable();
                                }
                            });
                            document.querySelector('#password').addEventListener('input', (e) => {
                                if(e.target.value.length > 6){
                                    valid1 = true;
                                } else {
                                    valid1 = false;
                                }
                                if(e.target.value === document.querySelector('#passwordConfirm').value){
                                    valid3 = true;
                                } else {
                                    valid3 = false;
                                }
                                if(valid1 && valid2 && valid3){
                                    document.querySelector('.checkoutError').classList.add('hidden');
                                    actions.enable();
                                } else {
                                    document.querySelector('.checkoutError').classList.remove('hidden');
                                    actions.disable();
                                }
                            });
                            document.querySelector('#passwordConfirm').addEventListener('input', (e) => {
                                if(e.target.value === document.querySelector('#password').value){
                                    valid3 = true;
                                } else {
                                    valid3 = false;
                                }
                                if(valid1 && valid2 && valid3){
                                    document.querySelector('.checkoutError').classList.add('hidden');
                                    actions.enable();
                                } else {
                                    document.querySelector('.checkoutError').classList.remove('hidden');
                                    actions.disable();
                                }
                            });
                        },
              
                      createOrder: function(data, actions) {
                        return actions.order.create({
                          purchase_units: [{"description":"Purpose Driven Planner Web Application with Video Course.","amount":{"currency_code":"USD","value":47}}]
                        });
                      },
              
                      onApprove: function(data, actions) {
                        return actions.order.capture().then(function(details) {
                            firebase.auth().createUserWithEmailAndPassword(document.querySelector('#email').value, document.querySelector('#passwordConfirm').value)
                                .then((user) => {
                                    window.location('/thankyou.html');
                                })
                                .catch((error) => {
                                    alert('Please contact support, something went wrong. purposedrivenplanner@gmail.com');
                                });
                        });
                      },
              
                      onError: function(err) {
                        alert('Please contact support, something went wrong. purposedrivenplanner@gmail.com');
                      }
                    }).render('#paypal-button-container');
                  }
                  initPayPalButton();
                </script>
            </form>
            <div class="checkout__content-benefits">
                <h2>Lorem ipsum dolor sit amet.</h2>
                <p><img src="./img/tick.svg" alt=""> Lorem ipsum dolor sit amet.</p>
                <p><img src="./img/tick.svg" alt=""> Lorem ipsum dolor sit amet.</p>
                <p><img src="./img/tick.svg" alt=""> Lorem ipsum dolor sit amet.</p>
                <p><img src="./img/tick.svg" alt=""> Lorem ipsum dolor sit amet.</p>
                <p><img src="./img/tick.svg" alt=""> Lorem ipsum dolor sit amet.</p>
                <p><img src="./img/tick.svg" alt=""> Lorem ipsum dolor sit amet.</p>
                <p><img src="./img/tick.svg" alt=""> Lorem ipsum dolor sit amet.</p>
                <p><img src="./img/tick.svg" alt=""> Lorem ipsum dolor sit amet.</p>
                <p><img src="./img/tick.svg" alt=""> Lorem ipsum dolor sit amet.</p>
                <p><img src="./img/tick.svg" alt=""> Lorem ipsum dolor sit amet.</p>
            </div>
        </div>
        <footer class="checkout__footer">
            <p>Lorem ipsum dolor, sit amet consectetur adipisicing elit. Autem perferendis libero aliquam asperiores. Sunt ullam ipsa quas autem magni impedit.</p>
        </footer>
    </div>

</body>
</html>