<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"
/>
    <title>Purpose Driven Planner | Checkout for pdf version of the planner</title>
    <link rel="stylesheet" href="./css/main.css" />
</head>
<body>
    <div class="checkoutContainer">
        <div class="checkout__header">
            <div class="checkout__header-heading">
                <h1>Purpose Driven Planner</h1>
                <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Nobis itaque voluptas sit eveniet ipsam quaerat!</p>
            </div>
            <div class="checkout__header-logo">
                <img src="./img/pdp-logo.svg" alt="">
            </div>
        </div>
        <div class="checkout__content">
            <form name="pdfpaid" id="pdfpaid" action="POST" data-netlify="true" class="checkoutForm">
                <h2 class="checkoutForm__heading">Checkout Form</h2>
                <p class="checkoutError hidden">Please fill out all of the fields</p>
                <div class="checkoutForm__group">
                    <label for="">Name:</label>
                    <input type="text" name="name" placeholder="Enter your name here" required id="name">
                </div>
                <div class="checkoutForm__group mb-3">
                    <label for="">Email:</label>
                    <input type="email" name="email" placeholder="Enter your email here" required id="email">
                </div>
                <div id="smart-button-container">
                    <div style="text-align: center;">
                      <div id="paypal-button-container"></div>
                    </div>
                  </div>
                <script src="https://www.paypal.com/sdk/js?client-id=sb&currency=USD" data-sdk-integration-source="button-factory"></script>
                <script>
                  function initPayPalButton() {
                    paypal.Buttons({
                      style: {
                        shape: 'pill',
                        color: 'white',
                        layout: 'vertical',
                        label: 'buynow',
                      },

                      onInit: function(data, actions) {

                        // Disable the buttons
                        let valid1 = false;
                        let valid2 = false;
                        actions.disable();
                        document.querySelector('#name').addEventListener('input', (e) => {
                            if(e.target.value.length){
                                valid1 = true;
                            } else {
                                valid1 = false;
                            }
                            if(valid1 && valid2){
                                document.querySelector('.checkoutError').classList.add('hidden');
                                actions.enable();
                            } else {
                                document.querySelector('.checkoutError').classList.remove('hidden');
                                actions.disable();
                            }
                        });
                        document.querySelector('#email').addEventListener('input', (e) => {
                            if (/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e.target.value)){
                                valid2 = true;
                            } else {
                                valid2 = false;
                            }
                            if(valid1 && valid2){
                                document.querySelector('.checkoutError').classList.add('hidden');
                                actions.enable();
                            } else {
                                document.querySelector('.checkoutError').classList.remove('hidden');
                                actions.disable();
                            }
                        });
                    },
              
                      createOrder: function(data, actions) {
                        return actions.order.create({
                          purchase_units: [{"description":"PDF version of Purpose Driven Planner","amount":{"currency_code":"USD","value":19.99}}]
                        });
                      },
              
                      onApprove: function(data, actions) {
                        return actions.order.capture().then(function(details) {
                          alert('Transaction completed by ' + details.payer.name.given_name + '!');
                          let myForm = document.getElementById('pdfpaid');
                            let formData = new FormData(myForm)
                            fetch('/', {
                                method: 'POST',
                                headers: { "Content-Type": "application/x-www-form-urlencoded" },
                                body: new URLSearchParams(formData).toString()
                            }).then(() => console.log('Form successfully submitted')).catch((error) =>
                                alert(error))
                            window.location('/landing/pdfthankyou.html');
                        });
                      },
              
                      onError: function(err) {
                        console.log(err);
                      }
                    }).render('#paypal-button-container');
                  }
                  initPayPalButton();
                </script>
            </form>
            <div class="checkout__content-benefits">
                <h2>Lorem ipsum dolor sit amet.</h2>
                <p><img src="./img/tick.svg" alt=""> Lorem ipsum dolor sit amet.</p>
                <p><img src="./img/tick.svg" alt=""> Lorem ipsum dolor sit amet.</p>
                <p><img src="./img/tick.svg" alt=""> Lorem ipsum dolor sit amet.</p>
                <p><img src="./img/tick.svg" alt=""> Lorem ipsum dolor sit amet.</p>
                <p><img src="./img/tick.svg" alt=""> Lorem ipsum dolor sit amet.</p>
                <p><img src="./img/tick.svg" alt=""> Lorem ipsum dolor sit amet.</p>
                <p><img src="./img/tick.svg" alt=""> Lorem ipsum dolor sit amet.</p>
                <p><img src="./img/tick.svg" alt=""> Lorem ipsum dolor sit amet.</p>
                <p><img src="./img/tick.svg" alt=""> Lorem ipsum dolor sit amet.</p>
                <p><img src="./img/tick.svg" alt=""> Lorem ipsum dolor sit amet.</p>
            </div>
        </div>
        <footer class="checkout__footer">
            <p>Lorem ipsum dolor, sit amet consectetur adipisicing elit. Autem perferendis libero aliquam asperiores. Sunt ullam ipsa quas autem magni impedit.</p>
        </footer>
    </div>
</body>
</html>